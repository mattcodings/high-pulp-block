(()=>{"use strict";var e={352:(e,t,r)=>{var a=r(34);t.C=a.createRoot,a.hydrateRoot},34:e=>{e.exports=window.ReactDOM}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=window.React;var t=r.n(e),a=r(352);class n extends t().Component{state={title:"",review:"",rating:0};addReview(e){e.preventDefault();const t={title:this.state.title,content:this.state.review,acf:{review_rating:parseInt(this.state.rating)||0},status:"publish"};this.props.addReview?.(t)}render(){return(0,e.createElement)("form",{className:"new-review-form",onSubmit:e=>this.addReview(e)},(0,e.createElement)("div",null,(0,e.createElement)("label",null,"Title:",(0,e.createElement)("input",{type:"text",value:this.state.title,onInput:e=>this.setState({title:e.target.value})}))),(0,e.createElement)("div",null,(0,e.createElement)("label",null,"Overall Rating:",(0,e.createElement)("input",{type:"number",value:this.state.rating,onInput:e=>this.setState({rating:e.target.value})}))),(0,e.createElement)("div",null,(0,e.createElement)("label",null,"Review:",(0,e.createElement)("textarea",{value:this.state.review,onInput:e=>this.setState({review:e.target.value})}))),(0,e.createElement)("button",{type:"submit"},"Add Review"))}}function s({rating:t,setRating:r,readonly:a}){const[n,s]=(0,e.useState)(t||0);return(0,e.createElement)("div",{className:a?"readonly stars":"stars"},[1,2,3,4,5].map((a=>(0,e.createElement)("span",{className:a<=n?"star on":"star off",onClick:()=>{r(a)},onMouseEnter:()=>{s(a)},onMouseLeave:()=>{s(t)}},"*"))))}class l extends t().Component{render(){let{title:t,review:r,rating:a}=this.props;return(0,e.createElement)("div",{className:"review-card"},(0,e.createElement)("div",{className:"review-title"},t),(0,e.createElement)(s,{rating:a,readonly:!0}),(0,e.createElement)("div",{className:"review-content",dangerouslySetInnerHTML:{__html:r}}))}}class i extends t().Component{render(){return(0,e.createElement)("div",{className:"review-list"},this.props.reviews.map((t=>(0,e.createElement)(l,{title:t.attributes.title.rendered,review:t.attributes.content.rendered,rating:t.attributes.acf.review_rating}))))}}class o extends t().Component{state={reviews:[],loggedIn:null};addReview(e){new wp.api.models.Review(e).save().done((e=>{console.log("saved!",e)})).fail((e=>{console.error("failed!",e)}))}getReviews(){const e=new wp.api.collections.Review;e.fetch().done((t=>{console.log("saved!",t,e),this.setState({reviews:e.models})})).fail((e=>{console.error("failed!",e)}))}getLoggedInUser(){(new wp.api.models.UsersMe).fetch().done((e=>{this.setState({loggedIn:!0})})).fail((e=>{this.setState({loggedIn:!1})}))}componentDidMount(){this.getReviews(),this.getLoggedInUser()}render(){return(0,e.createElement)("div",null,(0,e.createElement)("h3",null,"Latest Reviews"),(0,e.createElement)(i,{reviews:this.state.reviews}),(0,e.createElement)("hr",null),(0,e.createElement)("h3",null,"Submit a Review"),!0===this.state.loggedIn&&(0,e.createElement)(n,{addReview:e=>this.addReview(e)}),!1===this.state.loggedIn&&(0,e.createElement)("div",{className:"error-msg"},"You must be logged in to submit a review"))}}document.querySelectorAll(".wp-block-mz-submit-review").forEach((t=>{(0,a.C)(t).render((0,e.createElement)(o,null))}))})()})();